---
- name: Teardown
  block:
    - name: Delete Subnets
      amazon.aws.ec2_vpc_subnet:
        vpc_id: "{{ test_vpc_id }}"
        cidr: "{{ test_subnet_cidr }}"
        region: "{{ aws_region }}"
        state: absent
      ignore_errors: true

    - name: Delete a VPC
      amazon.aws.ec2_vpc_net:
        cidr_block: "{{ test_vpc_cidr }}"
        vpc_id: "{{ test_vpc_id }}"
        region: "{{ aws_region }}"
        state: absent
      ignore_errors: true

    - name: Delete a key
      amazon.aws.ec2_key:
        name: "{{ resource_prefix }}-ec2-key"
        region: "{{ aws_region }}"
        state: absent
      ignore_errors: true
